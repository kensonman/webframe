{%extends TMPL_BASE%}{%load i18n%}{%load django_tables2%}{%load method_override%}

{%block title%}{%blocktrans with user=user.username%}{{user}}'s preferences{%endblocktrans%}{%endblock%}

{%block scripts%}{{block.super}}
<script type="text/javascript"><!--
$(document).ready(function(){
	$('tr[prefId]').hover(function(){ $(this).addClass('active'); }, function(){ $(this).removeClass('active'); }).css('cursor', 'pointer').click(function(){
		window.location.href='{{ABSOLUTE_PATH}}users/{{currentuser.username}}/prefs/'+$(this).attr('prefId')+'/';
	});
});
//--></script>
{%endblock%}

{%block content%}<div class="jumbotron">
	<h1>{%blocktrans with user=user.username%}{{user}}'s preferences{%endblocktrans%}</h1>
	<hr/>

	<div class="pnl-padding">
		<form id="changePwdFrm" method="POST">
			{%csrf_token%}
			<h2>{%trans 'Preference.sections.changePassword'%}</h2>
			{%if not user.is_superuser%}
			<div class="field">
				<label for="oldPwdFld">{%trans 'BTUser.old-password'%}</label>
				<input type="password" name="oldPwd" id="oldPwdFld" class="form-control" required="true" placeholder="{%trans 'BTUser.old-password'%}"/>
			</div>
			{%endif%}
			<div class="field">
				<label for="newPwdFld">{%trans 'BTUser.password'%}</label>
				<input type="password" name="newPwd" id="newPwdFld" class="form-control" required="true" placeholder="{%trans 'BTUser.password'%}"/>
			</div>
			<div class="field">
				<label for="rePwdFld">{%trans 'BTUser.re-password'%}</label>
				<input type="password" name="rePwd" id="rePwdFld" class="form-control" required="true" placeholder="{%trans 'BTUser.re-password'%}"/>
			</div>
			<div class="pnl pnl-btns">
				<button type="submit" class="btn btn-warning">{%trans 'Preference.actions.changePassword'%}</button>
			</div>
		</form>

		<h2>{%trans 'Preference.sections.pin'%}</h2>
		{%with target=currentuser%}<form id="userFrm" method="POST" action="{{ABSOLUTE_PATH}}users/{{target.username|default:'add'}}/">
			{%csrf_token%}
			{%method_override 'PUT'%}
			<div class="field">
				<label for="first_nameFld">{%trans 'first name'%}</label>
				<input name="first_name" value="{{target.first_name|default:''}}" class="form-control" placeholder="{%trans 'first name'%}" required="true"/>
			</div>
			<div class="field">
				<label for="last_nameFld">{%trans 'last name'%}</label>
				<input name="last_name" value="{{target.last_name|default:''}}" class="form-control" placeholder="{%trans 'last name'%}" required="true"/>
			</div>
			<div class="field">
				<label for="emailFld">{%trans 'email address'%}</label>
				<input name="email" value="{{target.email|default:''}}" class="form-control" placeholder="{%trans 'email address'%}" required="true"/>
			</div>
			<div class="pnl pnl-btns">
				<button type="submit" class="btn btn-warning"><i class="fa fa-user"></i> {%trans 'User.actions.update'%}</button>
			</div>
		</form>{%endwith%}

		{%if user.is_superuser%}
		<h2>{%trans 'Preference.sections.config'%}</h2>
		{%render_table config%}
		<div class="pnl pnl-btns">
			<a class="btn btn-primary" href="add/?mode={{csrf_token}}"><i class="fa fa-plus"></i> {%trans 'Preference.actions.addConfig'%}</a>
		</div>
		{%endif%}

		<h2>{%trans 'Preference.sections.preference'%}</h2>
		{%render_table preference%}
		<div class="pnl pnl-btns">
			<a class="btn btn-primary" href="add/"><i class="fa fa-plus"></i> {%trans 'Preference.actions.addPref'%}</a>
		</div>
	</div>
</div>{%endblock%}
